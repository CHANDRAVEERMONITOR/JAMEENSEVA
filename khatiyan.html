<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ऑर्डर खतियान - JameenSeva.in</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f0f4f8; margin: 0; padding: 15px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); border-top: 5px solid #005689; }
        h2 { color: #005689; text-align: center; margin-bottom: 20px; font-size: 20px; }
        .form-group { margin-bottom: 15px; }
        label { font-weight: bold; display: block; margin-bottom: 5px; color: #333; font-size: 14px; }
        select, input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-size: 16px; background-color: #fafafa; }
        .row { display: flex; gap: 10px; }
        .row .form-group { flex: 1; }
        button { width: 100%; padding: 15px; background-color: #005689; color: white; border: none; border-radius: 6px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        .note { font-size: 12px; color: #666; margin-top: 10px; text-align: center; }
        .payment-box { background:#fff9e6; border:1px solid #ffeeba; padding:15px; border-radius:10px; margin-top: 20px; text-align: center; min-height: 100px; }
        .btn-cod { background-color: #28a745; margin-top: 10px; }
        #razorpay-container { margin: 15px 0; }
    </style>
</head>
<body>

<div class="container" id="main-content">
    <h2> ऑर्डर फॉर्म- घर पर खतियान मंगवाएं </h2>
    
    <div class="form-group">
        <label>1. जिला चुनें (District):</label>
        <select id="district" onchange="loadBlocks()">
            <option value="">-- चुनें --</option>
        </select>
    </div>
    <div class="form-group">
        <label>2. प्रखंड चुनें (Block):</label>
        <select id="block"><option value="">-- पहले जिला चुनें --</option></select>
    </div>
    <div class="row">
        <div class="form-group"><label>3. थाना नंबर:</label><input type="number" id="thana_no" placeholder="उदा. 125"></div>
        <div class="form-group"><label>4. मौजा/गाँव:</label><input type="text" id="village" placeholder="गाँव का नाम"></div>
    </div>
    <div class="form-group"><label>5. खाता नंबर:</label><input type="text" id="khata_no"></div>
    <div class="form-group"><label>6. खेसरा नंबर:</label><input type="text" id="khesra_no"></div>
    <div class="form-group">
        <label>7. खतियान का प्रकार:</label>
        <div style="display: flex; gap: 10px; background: #f9f9f9; padding: 10px; border-radius: 6px; border: 1px solid #ddd;">
            <label><input type="radio" name="khatiyan_type" value="नया (C.S.)" checked> नया</label>
            <label><input type="radio" name="khatiyan_type" value="पुराना (R.S.)"> पुराना</label>
            <label><input type="radio" name="khatiyan_type" value="चकबंदी"> चकबंदी</label>
        </div>
    </div>
    <div class="form-group"><label>8. रैयत का नाम:</label><input type="text" id="raiyat_name"></div>
    <div class="form-group"><label>9. पूरा पता:</label><input type="text" id="full_address"></div>
    <div class="form-group"><label>10. पिन कोड:</label><input type="text" id="pincode"></div>
    <div class="form-group"><label>11. मोबाइल नंबर:</label><input type="tel" id="mobile" maxlength="10"></div>

    <button id="submit-btn" onclick="submitOrder()">ऑर्डर बुक करें (Confirm Order)</button>
    <p class="note">बुक करने के बाद आपको पेमेंट और ट्रैकिंग ID मिलेगी।</p>
</div>

<script>
// Bihar Data (Keeping it short for the example, use your full list)
const biharData = {"Patna": ["Bakhtiarpur", "Barh"], "Gaya": ["Amas", "Atri"]}; // Add all districts here

const districtSelect = document.getElementById("district");
for (let dist in biharData) {
    let opt = document.createElement("option"); opt.value = dist; opt.innerHTML = dist;
    districtSelect.appendChild(opt);
}

function loadBlocks() {
    const blockSelect = document.getElementById("block");
    const selectedDist = districtSelect.value;
    blockSelect.innerHTML = '<option value="">-- ब्लॉक चुनें --</option>';
    if (selectedDist) {
        biharData[selectedDist].forEach(block => {
            let opt = document.createElement("option"); opt.value = block; opt.innerHTML = block;
            blockSelect.appendChild(opt);
        });
    }
}

function submitOrder() {
    const btn = document.getElementById("submit-btn");
    const mobile = document.getElementById("mobile").value;
    if(mobile.length < 10) { alert("सही मोबाइल नंबर भरें!"); return; }

    btn.disabled = true;
    btn.innerText = "प्रोसेसिंग...";

    const trackingID = "JS-" + Math.floor(1000 + Math.random() * 9000);
    const formData = {
        "ORDER ID": trackingID,
        "DATE": new Date().toLocaleDateString('hi-IN'),
        "जिला": document.getElementById("district").value,
        "प्रखंड": document.getElementById("block").value,
        "मोबाइल": mobile
        // Add other fields here as per your SheetDB headers
    };

    fetch('https://sheetdb.io/api/v1/tethdim34qjsy', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ data: [formData] })
    })
    .then(res => {
        showSuccessPage(trackingID);
    })
    .catch(err => {
        alert("Error!");
        btn.disabled = false;
    });
}

function showSuccessPage(id) {
    // 1. Success Screen HTML
    document.getElementById("main-content").innerHTML = `
        <div style="text-align:center;">
            <h2 style="color:#28a745;">✅ ऑर्डर बुक हो गया!</h2>
            <p>आपकी ट्रैकिंग ID: <b>${id}</b></p>
            <div class="payment-box">
                <p><b>पेमेंट का तरीका चुनें:</b></p>
                <div id="razorpay-container"></div> <p style="margin:10px 0;">--- या ---</p>
                <button onclick="confirmCOD('${id}')" class="btn-cod">Cash on Delivery (COD)</button>
            </div>
        </div>
    `;

    // 2. Load Razorpay Button Manually
    const script = document.createElement("script");
    script.src = "https://checkout.razorpay.com/v1/payment-button.js";
    script.setAttribute("data-payment_button_id", "pl_SCKTQmKjqJ35JV");
    script.async = true;
    document.getElementById("razorpay-container").appendChild(script);
}

function confirmCOD(id) {
    alert("आपका COD ऑर्डर (ID: " + id + ") स्वीकार कर लिया गया है।");
    window.location.reload();
}
</script>
</body>
</html>
